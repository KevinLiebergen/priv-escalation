from techniques.config.constants import open_green
from techniques.config.constants import open_red
from techniques.config.constants import close
from techniques.config.utilities import print_title_technique
from techniques.config.utilities import print_mitigation


def print_exploitation_message():
    text = "( Exploitation for Privilege Escalation )"
    print_title_technique(text)


def mitigation_app_isolation():
    text = ("Make it difficult for adversaries to advance their operation "
    "through exploitation of undiscovered or unpatched vulnerabilities by "
    "using sandboxing. Other types of virtualization and application "
    "microsegmentation may also mitigate the impact of some types of "
    "exploitation. Risks of additional exploits and weaknesses in these "
    "systems may still exist.")
    print_mitigation(text)


def mitigation_exploit_protection():
    text = ("Security applications that look for behavior used during "
    "exploitation such as Windows Defender Exploit Guard (WDEG) and the "
    "Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate "
    "some exploitation behavior. Control flow integrity checking is another "
    "way to potentially identify and stop a software exploit from occurring. "
    "Many of these protections depend on the architecture and target "
    "application binary for compatibility and may not work for software "
    "components targeted for privilege escalation.")
    print_mitigation(text)


def mitigation_threat_intelligence_program():
    text = ("Develop a robust cyber threat intelligence capability to "
    "determine what types and levels of threat may use software exploits "
    "and 0-days against a particular organization.")
    print_mitigation(text)


def mitigation_update_software():
    text = ("Update software regularly by employing patch management for "
    "internal enterprise endpoints and servers.")
    print_mitigation(text)


def analyze():
    print_exploitation_message()
    mitigation_update_software()
    mitigation_exploit_protection()
    mitigation_threat_intelligence_program()
    mitigation_update_software()